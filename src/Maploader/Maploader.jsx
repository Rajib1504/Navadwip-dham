import React, { useRef, useEffect } from 'react';
import { gsap } from 'gsap';

const MapPreloader = ({ onComplete }) => {
  const svgRef = useRef(null);

  useEffect(() => {
    // Enable body scroll when component unmounts
    return () => {
      document.body.style.overflow = 'auto';
    };
  }, []);

  useEffect(() => {
    const ctx = gsap.context(() => {
      // Disable scroll during animation
      document.body.style.overflow = 'hidden';

      const tl = gsap.timeline({
        onComplete: () => {
          // Re-enable scroll when animation completes
          document.body.style.overflow = 'auto';
          
          onComplete();
          
          // Optional fade out
          gsap.to("#map-preloader", {
            opacity: 0,
            duration: 0.5,
            onComplete: () => {
              const preloader = document.getElementById('map-preloader');
              if (preloader) preloader.style.display = 'none';
            }
          });
        }
      });

      tl.fromTo(
        ".map-path",
        { strokeDashoffset: 1 },
        { 
          strokeDashoffset: 0,
          duration: 5,
          ease: "power3.inOut"
        }
      );
    }, svgRef);

    return () => ctx.revert(); // Cleanup GSAP context
  }, []);

  return (
    <div id="map-preloader" className="fixed inset-0 z-[9999] bg-[#1C1B1B] flex justify-center items-center">
      <div class="container">
    <div class="loader">
<svg ref={svgRef} aria-hidden="true" class="map" viewBox="0 0 460 530">
		<path class="map-path" d="M247.1,21.3c3.1.1,8.3,2.2,10.6,4.3,1.8,1.7,5.9,9.1,8.2,8.9,1.2,0,7.9-10.7,9.9-12.7,4.1-4,9.6-6.2,14-9.6C295.2,8.1,300.9-.1,308.2,0s0,0,.1,0c2.4,0,6.3,3.4,6.6,4.6.6,2.2-2.3,15.4-2.3,19.5s1.4,7,5.3,7.3c4.2.4,8.2-1,13,1.2,2.8,1.2,2.8,4.4,5.9,5.1,4.5,1,8.2-1.9,13.2,0,3,1.2,3.2,3.9,5.6,5.5,2.8,1.9,7.7,1.9,9.7,3.7,1.6,1.5,1.4,5.2,3.7,5.8,1.5.4,3.5-.7,5.3-.7,5,0,17.3-1.2,18.5,5.2,1.3,6.5-8.6,28.4-3.7,33.3,2.5,2.5,18.4,2.8,23.2,4.7,8.5,3.3,8.7,19.4,6.8,27-.6,2.2-2.3,5.2-2.6,6.9-.3,2,2.7,14.2,3.9,16.2,2.3,4,6.2,4,8.6,6.4,4.6,4.9-2.8,6.2-3.6,9.8-1.1,5,10.4,23.4,13.9,27.9h0c5.8,7.5,22.6,17.2,15.7,28.7-3.1,5.1-20.7,4.1-26.9,5.3-8.1,1.6-13.4,4.1-18.8,6.2-2,1.9-3.9,3.9-5.4,6-1.9,2.8-2.1,6.5-1.5,9.9.6,1.4,1.2,2.9,1.9,3.9,2.4,3.3,9.2,9.3,9.7,12.3.2,1.8-.3,3.9.2,5.4.5,1.6,3.5,1.6,3.8,4.1.4,4.4-10.3,12.5-14.5,12.2-2.1-.1-3.8-2.4-6.3-2.4-2.1,0-3.1,1.9-4.8,2.3-2.3.5-4.8-.2-7.3.5-2.1.6-6.3,4.2-9.4,5.5-8,3.3-17.2,1.6-19.9,10.8-1.3,4.5-4.8,17.8-3.1,21.7,1.8,4.2,17.7,7.7,18.9,11.8,1.9,6.8-5.9,10.2-6.8,13.4-1.3,4.6,1.9,20.5-4,22.7-2.5,1-6,.7-8.5,1.8-8.9,3.9-3,14.7-4.2,21-.6,3.1-5,5.5-4.7,8.7.3,2.8,7.5,7,9.4,9.5,3.9,4.8,2.5,4.6,7.9,9.4,10.1,8.9,2.6,25,9.9,33.4,3.4,3.9,6.9,2.3,3.3,9-1.2,2.2-7.4,11.4-9.2,12-6,1.9-14.5-4.5-18.9-.9-5.8,4.7,10,12.8,5.6,19.6-1.5,2.5-5.2.5-6.7.7-2,.2-3.7,1.1-5.6,1.3-5.8.7-10.9-.6-16,3.7-5.3,4.6-6.9,20-10,22.5-.8.7-3.3,1.6-4.5,1.6-4.1.2-14-6.4-17.9-8.9-1.6-1-2.8-2.9-4.2-3.7-10.8-5.7-16,18.6-21.9,18.1-2.1-.2-1.9-2.7-3.1-4.1-2-2.3-7.2-3.7-5.8-8.1.9-2.8,15.6-4.1,14-10.4-.6-2.4-3.2,1-5.5,0-1-.4-8.1-8.5-9-9.9-3.1-4.8-2.6-9.8-4.8-14.9-4.2-9.5-7.6-4.2-14-8-1.4-.9-7.3-6.7-8.3-8.2-4.5-6.4-3.8-19.5-14.7-21.5-4.5-.8-5.8,1.1-8.6,1.3h-.2c0,.1-.3.3-.4.5l-13.8,9.1h-.4c-2.7,9.4-3.5,19.5-7.5,28.5v.6c-3.2,9.4-8.4,14.2-15.7,14.2h-.8l-3.9-2.4c-.2,0-.6.1-.8,0l-11-7.1h-.8l-3.9-2.4c-.8-.3-1.8-.5-2.4-.8-5.4-3.6-10.3-7.8-14.9-12.6h-.8l-1.6-.8h-.8l-3.1-.8h-.8l-1.6-.8h-.8l-2.4-1.6c-.2-.1-.6.1-.8,0-3.5-2.8-6.6-6-9.4-9.5,0-.2,0-.6,0-.8-4.7-9.8-9.9-11.9-15.7-6.3-.6,0-2,.1-2.4,0l-1.6-1.6c0-.2,0-.6,0-.8l-.8-1.6v-2.4c2-3.6,5.1-6.5,9.2-8.6,3.7-2.6,4.3-4.2,1.8-4.8-2-.3-4.3.2-6.3,0-2.3-.6-4.7-1.3-6.3-3.2,0-.2,0-.6,0-.8-1.2-3.8-2.8-4.6-4.7-2.4h-.8c-7.1,5.4-10.7-.6-13.3-7.1l-1.6-2.3c0-.2,0-.6,0-.8-3.5-3.9-6.6-7-9.4-9.5-.9.2-1.6.6-2.4.8-1.3.3-2.1.2-3.1-.8,0-.2,0-.5,0-.8v-5.6l-.8-1.6c0-.3,0-.6,0-.8l-2.9-2.1c-10.8-4-17.9-11-21.4-20.8v-.8c.5-4.7-.8-8.2-3.8-10.4h-.4c-.8,0-4.4-2-5.2-2.6-6.5-4.9-7.3-13.4-6.1-21,.8-5.2,6.5-11.1,4.1-16.3-1.3-2.9-4.6-2.3-5.1-8.2-.2-3.3,1.1-16.3,1.8-19.6.6-2.8,4.1-5,4.5-8.9.4-3.7-1.3-7.2-1.5-10.9h0c-1-.7-.5-3.3-1.5-4.1-.6-.5-4.5,1.7-7.9-2.3-4.2-5-1.9-12,1.6-16.6,3.1-4.1,14.9-11,16.1-13.8,1-2.1.6-7.1,1.6-10.2,5.2-16.1,23-2.6,34.1-3.2-3.5-11-13.6-3.5-19.2-11.9-3.2-4.8-1.2-5.6-1.5-9.7-.2-3.3-2.5-7.2-1.7-10,.9-3,6.9-6.2,10.1-8.5-2.9-1.5-7.3-1.3-10.7-3.4-6.9-4.4-6.6-16.7-.9-22,2.5-2.4,5.1-2.4,7.7-4.1,2.9-1.9,8.4-7.3,11.2-7.7,2.7-.4,2.4,2.9,4.7,4.6,2.2,1.7,6.3,1.9,8.5,4,2.4,2.2,2.9,7.2,6.3,7.2s3.6-3.2,3.5-5.9c-.3-6.2-3.4-25.4-5-31.3-2-7.7-9-12.1-1.6-20.5,3.3-3.7,25.7-17.5,30.1-18,4.6-.5,2.7,6.9,3.4,7.7.5.6,4.7.7,5.7,0l5.9-3.9-1,.6c.4-1.4,1.4-2.7,3.3-3.4,2.7-1.1,13.7-2,16.9-2s16.9,2,22.5,3.3c4.8-.6,9.4-2.1,14-3.5,4-1.2,8-2.5,11.6-4.7,3.7-2.2,5.5-5.2,7.9-8.7.5-.7.9-1.2,1.4-1.8,1.3-3,2.7-6.2,4.3-9.6,1.4-3.1,4.4-9.8,8.1-9.9,5.7-.1,9.4,4.9,16.9.3,1.2-.7,15.9-16.3,16.9-17.8,4-6,1.9-13.8,11.8-13.4" pathLength="1"/>
	</svg>
    </div>
  </div>
 
    </div>
  );
};

export default MapPreloader;